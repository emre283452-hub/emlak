url = "https://raw.githubusercontent.com/volkanceylan/turkiye-iller-ilceler-json/master/il-ilce.json"
veri = requests.get(url).json()
iller = [item['il'] for item in veri]
ilceler_dict = {item['il']: item['ilceler'] for item in veri}

st.title("Üst Düzey Emlak Değerleme AI")

il = st.selectbox("İl", iller)
ilce = st.selectbox("İlçe", ilceler_dict[il])
m2 = st.number_input("Metrekare", min_value=10)
oda = st.number_input("Oda Sayısı", min_value=1)
bina_yasi = st.number_input("Bina Yaşı", min_value=0)

if st.button("Tahmini Fiyatı Hesapla"):
    girdi = pd.DataFrame({
        'm2': [m2],
        'oda_sayisi': [oda],
        'bina_yasi': [bina_yasi],
        'ilce': [ilce]
    })
    tahmin = model.predict(girdi)[0]
    st.success(f"Tahmini Fiyat: {tahmin:,.0f} TL")

    st.subheader("İlçe Bazlı Ortalama Fiyat Haritası")
    st.image("fiyat_haritasi.png")
